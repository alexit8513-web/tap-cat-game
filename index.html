<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tap Cat Game</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }

        .header {
            margin-bottom: 20px;
        }

        .stats {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .cat-container {
            position: relative;
            margin: 30px 0;
        }

        #cat {
            width: 200px;
            height: 200px;
            cursor: pointer;
            transition: transform 0.1s;
            border-radius: 50%;
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 80px;
            margin: 0 auto;
            user-select: none;
        }

        #cat:active {
            transform: scale(0.95);
        }

        #effects {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
        }

        .particle {
            position: absolute;
            font-size: 20px;
            font-weight: bold;
            animation: floatUp 1s ease-out forwards;
            white-space: nowrap;
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(-50px) scale(1.5);
                opacity: 0;
            }
        }

        .shop {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .shop-title {
            font-size: 20px;
            margin-bottom: 15px;
            color: #ffd700;
        }

        .shop-btn {
            width: 100%;
            padding: 15px;
            margin: 8px 0;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .shop-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }

        .shop-btn:active {
            transform: translateY(0);
        }

        .shop-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: rgba(255, 255, 255, 0.1) !important;
        }

        .level-up {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 32px;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            animation: levelUp 3s ease-out forwards;
            pointer-events: none;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px 40px;
            border-radius: 20px;
            border: 3px solid #ffd700;
            text-align: center;
        }

        @keyframes levelUp {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 0; }
            20% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            80% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
        }

        .instructions {
            margin-top: 20px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            line-height: 1.4;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üê± Tap Cat</h1>
            <p>–¢–∞–ø–∞–π –ø–æ –∫–æ—Ç—É, –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—á–∫–∏ –∏ —É–ª—É—á—à–∞–π!</p>
        </div>

        <div class="stats">
            <div class="stat-row">
                <span>üèÜ –û—á–∫–∏:</span>
                <span id="score">0</span>
            </div>
            <div class="stat-row">
                <span>üí∞ –î–µ–Ω—å–≥–∏:</span>
                <span id="money">100</span>
            </div>
            <div class="stat-row">
                <span>üéØ –£—Ä–æ–≤–µ–Ω—å:</span>
                <span id="level">1</span>
            </div>
            <div class="stat-row">
                <span>üí™ –°–∏–ª–∞ –∫–ª–∏–∫–∞:</span>
                <span id="power">1</span>
            </div>
            <div class="stat-row">
                <span>‚ö° –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä:</span>
                <span id="autoPower">0</span>
            </div>
        </div>

        <div class="cat-container">
            <div id="cat">üê±</div>
            <div id="effects"></div>
        </div>

        <div class="shop">
            <div class="shop-title">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω —É–ª—É—á—à–µ–Ω–∏–π</div>
            <button id="clickUpgradeBtn" class="shop-btn" onclick="buyUpgrade('click')">
                üí™ –£—Å–∏–ª–∏—Ç–µ–ª—å (+1) - 50üí∞
            </button>
            <button id="autoClickUpgradeBtn" class="shop-btn" onclick="buyUpgrade('auto')">
                ‚ö° –ê–≤—Ç–æ–∫–ª–∏–∫ (+1) - 100üí∞
            </button>
        </div>

        <div class="instructions">
            <p>üí° <strong>–ö–∞–∫ –∏–≥—Ä–∞—Ç—å:</strong></p>
            <p>‚Ä¢ –¢–∞–ø–∞–π –ø–æ –∫–æ—Ç—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ—á–∫–æ–≤ –∏ –¥–µ–Ω–µ–≥</p>
            <p>‚Ä¢ –ü–æ–∫—É–ø–∞–π —É–ª—É—á—à–µ–Ω–∏—è –≤ –º–∞–≥–∞–∑–∏–Ω–µ</p>
            <p>‚Ä¢ –ü–æ–≤—ã—à–∞–π —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –±–æ–Ω—É—Å–æ–≤</p>
            <p>‚Ä¢ –ê–≤—Ç–æ–∫–ª–∏–∫–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!</p>
        </div>
    </div>

    <script>
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let score = 0;
        let money = 100;
        let level = 1;
        let clickPower = 1;
        let autoClickPower = 0;
        let autoClickInterval = null;

        // –ë–∞–ª–∞–Ω—Å –∏–≥—Ä—ã
        const gameBalance = {
            // –°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏–π (–ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è)
            clickUpgradeBaseCost: 50,
            autoClickBaseCost: 100,
            
            // –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —É—Ä–æ–≤–Ω–µ–π
            levelRequirements: [0, 200, 500, 1000, 2000, 4000, 8000, 15000, 25000, 50000],
            
            // –ë–æ–Ω—É—Å—ã –∑–∞ —É—Ä–æ–≤–Ω–∏
            levelBonuses: [0, 50, 100, 200, 300, 500, 750, 1000, 1500, 2000]
        };

        // –¢–µ–∫—É—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏–π
        let currentClickUpgradeCost = gameBalance.clickUpgradeBaseCost;
        let currentAutoClickCost = gameBalance.autoClickBaseCost;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.ready();

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–∞–ø–∞
        function tapCat() {
            // –î–æ–±–∞–≤–ª—è–µ–º –æ—á–∫–∏ –∏ –¥–µ–Ω—å–≥–∏
            score += clickPower;
            money += clickPower;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            
            // –°–æ–∑–¥–∞–µ–º —ç—Ñ—Ñ–µ–∫—Ç —á–∞—Å—Ç–∏—Ü
            createParticle(`+${clickPower}`, '#ffd700');
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–æ—Ç–∞
            animateCat();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å
            checkLevelUp();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            saveProgress();
        }

        // –§—É–Ω–∫—Ü–∏—è –ø–æ–∫—É–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π
        function buyUpgrade(type) {
            if (type === 'click') {
                if (money >= currentClickUpgradeCost) {
                    money -= currentClickUpgradeCost;
                    clickPower += 1;
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ª–µ–¥—É—é—â–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è (–ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ)
                    currentClickUpgradeCost = Math.floor(currentClickUpgradeCost * 1.8);
                    
                    updateUI();
                    saveProgress();
                    createParticle('üí™ +1 —Å–∏–ª–∞!', '#00ff00');
                } else {
                    createParticle('‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥!', '#ff0000');
                }
            } else if (type === 'auto') {
                if (money >= currentAutoClickCost) {
                    money -= currentAutoClickCost;
                    autoClickPower += 1;
                    
                    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å–ª–µ–¥—É—é—â–µ–≥–æ –∞–≤—Ç–æ–∫–ª–∏–∫–∞
                    currentAutoClickCost = Math.floor(currentAutoClickCost * 2.2);
                    
                    startAutoClick();
                    updateUI();
                    saveProgress();
                    createParticle('‚ö° –ê–≤—Ç–æ–∫–ª–∏–∫ +1!', '#00ffff');
                } else {
                    createParticle('‚ùå –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–µ–Ω–µ–≥!', '#ff0000');
                }
            }
        }

        // –ó–∞–ø—É—Å–∫ –∞–≤—Ç–æ–∫–ª–∏–∫–µ—Ä–∞
        function startAutoClick() {
            if (autoClickInterval) clearInterval(autoClickInterval);
            autoClickInterval = setInterval(() => {
                if (autoClickPower > 0) {
                    score += autoClickPower;
                    money += autoClickPower;
                    updateUI();
                    // –°–æ–∑–¥–∞–µ–º —á–∞—Å—Ç–∏—Ü—ã –¥–ª—è –∞–≤—Ç–æ–∫–ª–∏–∫–∞ (–º–µ–Ω–µ–µ –∑–∞–º–µ—Ç–Ω—ã–µ)
                    if (Math.random() > 0.7) { // 30% —à–∞–Ω—Å –ø–æ–∫–∞–∑–∞—Ç—å —á–∞—Å—Ç–∏—Ü—É
                        createParticle(`+${autoClickPower}`, '#00aa00');
                    }
                }
            }, 1000);
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏
            document.getElementById('score').textContent = formatNumber(score);
            document.getElementById('money').textContent = formatNumber(money);
            document.getElementById('level').textContent = level;
            document.getElementById('power').textContent = clickPower;
            document.getElementById('autoPower').textContent = autoClickPower;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ —É–ª—É—á—à–µ–Ω–∏–π –ø–æ ID
            const clickBtn = document.getElementById('clickUpgradeBtn');
            const autoBtn = document.getElementById('autoClickUpgradeBtn');
            
            if (clickBtn) {
                clickBtn.textContent = `üí™ –£—Å–∏–ª–∏—Ç–µ–ª—å (+1) - ${formatNumber(currentClickUpgradeCost)}üí∞`;
                clickBtn.disabled = money < currentClickUpgradeCost;
            }
            
            if (autoBtn) {
                autoBtn.textContent = `‚ö° –ê–≤—Ç–æ–∫–ª–∏–∫ (+1) - ${formatNumber(currentAutoClickCost)}üí∞`;
                autoBtn.disabled = money < currentAutoClickCost;
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
            updateLevelProgress();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —É—Ä–æ–≤–Ω—è
        function updateLevelProgress() {
            const nextLevelScore = getNextLevelRequirement();
            if (nextLevelScore === 0) return;
            
            const progress = (score / nextLevelScore * 100);
            
            // –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
            let progressBar = document.getElementById('levelProgress');
            if (!progressBar) {
                progressBar = document.createElement('div');
                progressBar.id = 'levelProgress';
                progressBar.style.width = '100%';
                progressBar.style.height = '5px';
                progressBar.style.background = 'rgba(255,255,255,0.3)';
                progressBar.style.borderRadius = '10px';
                progressBar.style.marginTop = '10px';
                progressBar.style.overflow = 'hidden';
                
                const progressFill = document.createElement('div');
                progressFill.id = 'levelProgressFill';
                progressFill.style.height = '100%';
                progressFill.style.background = 'linear-gradient(90deg, #ffd700, #ff6b00)';
                progressFill.style.transition = 'width 0.3s ease';
                progressFill.style.width = '0%';
                progressBar.appendChild(progressFill);
                
                document.querySelector('.stats').appendChild(progressBar);
            }
            
            const progressFill = document.getElementById('levelProgressFill');
            if (progressFill) {
                progressFill.style.width = `${Math.min(progress, 100)}%`;
            }
        }

        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
        function getNextLevelRequirement() {
            return level < gameBalance.levelRequirements.length ? gameBalance.levelRequirements[level] : 0;
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö —á–∏—Å–µ–ª
        function formatNumber(num) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(1) + 'M';
            }
            if (num >= 1000) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toString();
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —á–∞—Å—Ç–∏—Ü
        function createParticle(text, color) {
            const effects = document.getElementById('effects');
            if (!effects) return;
            
            const particle = document.createElement('div');
            
            particle.className = 'particle';
            particle.textContent = text;
            particle.style.color = color;
            particle.style.left = Math.random() * 80 + 10 + '%';
            particle.style.top = '50%';
            particle.style.textShadow = '0 2px 10px rgba(0,0,0,0.5)';
            
            effects.appendChild(particle);
            
            // –£–¥–∞–ª—è–µ–º —á–∞—Å—Ç–∏—Ü—É –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                if (particle.parentNode) {
                    particle.parentNode.removeChild(particle);
                }
            }, 1000);
        }

        // –ê–Ω–∏–º–∞—Ü–∏—è –∫–æ—Ç–∞
        function animateCat() {
            const cat = document.getElementById('cat');
            if (!cat) return;
            
            cat.style.transform = 'scale(0.95)';
            
            setTimeout(() => {
                cat.style.transform = 'scale(1)';
            }, 100);
        }

        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≤—ã—à–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è
        function checkLevelUp() {
            const nextLevelScore = getNextLevelRequirement();
            if (nextLevelScore > 0 && score >= nextLevelScore) {
                levelUp();
            }
        }

        // –ü–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
        function levelUp() {
            level++;
            
            // –ù–∞—á–∏—Å–ª—è–µ–º –±–æ–Ω—É—Å –∑–∞ —É—Ä–æ–≤–µ–Ω—å
            const bonus = gameBalance.levelBonuses[level - 1] || 0;
            money += bonus;
            
            showLevelUp();
            updateUI();
            saveProgress();
        }

        // –ü–æ–∫–∞–∑ –∞–Ω–∏–º–∞—Ü–∏–∏ —É—Ä–æ–≤–Ω—è
        function showLevelUp() {
            const levelUp = document.createElement('div');
            levelUp.className = 'level-up';
            levelUp.innerHTML = `
                <div style="text-align: center;">
                    <div style="font-size: 48px; margin-bottom: 10px;">üéâ</div>
                    <div>–£—Ä–æ–≤–µ–Ω—å ${level}!</div>
                    <div style="font-size: 16px; margin-top: 10px; color: #ffd700;">
                        +${formatNumber(gameBalance.levelBonuses[level - 1] || 0)}üí∞ –±–æ–Ω—É—Å!
                    </div>
                </div>
            `;
            
            document.body.appendChild(levelUp);
            
            setTimeout(() => {
                if (levelUp.parentNode) {
                    levelUp.parentNode.removeChild(levelUp);
                }
            }, 3000);
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function saveProgress() {
            try {
                localStorage.setItem('tapCat_score', score);
                localStorage.setItem('tapCat_money', money);
                localStorage.setItem('tapCat_level', level);
                localStorage.setItem('tapCat_clickPower', clickPower);
                localStorage.setItem('tapCat_autoClickPower', autoClickPower);
                localStorage.setItem('tapCat_clickUpgradeCost', currentClickUpgradeCost);
                localStorage.setItem('tapCat_autoClickCost', currentAutoClickCost);
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', e);
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        function loadProgress() {
            try {
                const savedScore = localStorage.getItem('tapCat_score');
                const savedMoney = localStorage.getItem('tapCat_money');
                const savedLevel = localStorage.getItem('tapCat_level');
                const savedClickPower = localStorage.getItem('tapCat_clickPower');
                const savedAutoClickPower = localStorage.getItem('tapCat_autoClickPower');
                const savedClickUpgradeCost = localStorage.getItem('tapCat_clickUpgradeCost');
                const savedAutoClickCost = localStorage.getItem('tapCat_autoClickCost');
                
                if (savedScore !== null) score = parseInt(savedScore) || 0;
                if (savedMoney !== null) money = parseInt(savedMoney) || 100;
                if (savedLevel !== null) level = parseInt(savedLevel) || 1;
                if (savedClickPower !== null) clickPower = parseInt(savedClickPower) || 1;
                if (savedAutoClickPower !== null) {
                    autoClickPower = parseInt(savedAutoClickPower) || 0;
                    if (autoClickPower > 0) startAutoClick();
                }
                if (savedClickUpgradeCost !== null) currentClickUpgradeCost = parseInt(savedClickUpgradeCost) || gameBalance.clickUpgradeBaseCost;
                if (savedAutoClickCost !== null) currentAutoClickCost = parseInt(savedAutoClickCost) || gameBalance.autoClickBaseCost;
            } catch (e) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', e);
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
        function initGame() {
            // –í–µ—à–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –∫–æ—Ç–∞
            const cat = document.getElementById('cat');
            if (cat) {
                cat.addEventListener('click', tapCat);
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å
            loadProgress();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            
            console.log('üê± –ò–≥—Ä–∞ Tap Cat –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞!');
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É –∫–æ–≥–¥–∞ DOM –∑–∞–≥—Ä—É–∂–µ–Ω
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initGame);
        } else {
            initGame();
        }
    </script>
</body>
</html>
